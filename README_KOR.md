# Google Sheets 쿠폰 관리 시스템

이 프로젝트는 Google Apps Script와 Google 스프레드시트를 사용하여 구축된 쿠폰 관리 시스템입니다. 웹 앱 인터페이스를 통해 쿠폰, 만료일, 상품권 잔액 등을 추적하고 관리할 수 있습니다.

## 주요 기능

*   새 쿠폰 정보 추가: 바코드, 만료일.
*   쿠폰을 상품권으로 표시하고 초기 잔액 및 현재 잔액 추적.
*   상품권 사용 내역 기록 및 잔액 자동 업데이트.
*   가장 최근에 추가된 5개 쿠폰 보기.
*   전체 쿠폰 목록 보기 (다음 시각적 표시 포함):
    *   만료된 쿠폰.
    *   만료일이 임박한 쿠폰 (7일 이내).
*   입력일 기준으로 전체 쿠폰 목록 필터링.
*   데이터는 Google 스프레드시트에 저장됩니다.

## 설정 안내

1.  **Google 스프레드시트 생성:**
    *   [Google Sheets](https://sheets.google.com)로 이동하여 새 빈 스프레드시트를 만듭니다.
    *   원하는 이름으로 지정할 수 있습니다 (예: "내 쿠폰").

2.  **스프레드시트 ID 가져오기:**
    *   새로 만든 스프레드시트를 엽니다.
    *   스프레드시트 ID는 URL에서 `/d/`와 `/edit` 사이에 있는 긴 문자열입니다.
    *   예: URL이 `https://docs.google.com/spreadsheets/d/SPREADSHEET_ID_HERE/edit#gid=0`인 경우, `SPREADSHEET_ID_HERE`가 스프레드시트 ID입니다.
    *   이 ID를 복사합니다.

3.  **Google Apps Script 편집기 열기:**
    *   스프레드시트에서 "확장 프로그램" > "Apps Script"로 이동합니다. 새 탭에서 Apps Script 편집기가 열립니다.

4.  **프로젝트 파일 복사:**
    *   이 프로젝트에는 다음 두 개의 파일이 필요합니다:
        *   `Code.gs`
        *   `index.html`
    *   Apps Script 편집기에서:
        *   기본 `Code.gs` 파일이 있다면 내용을 삭제하고, **이 프로젝트의** `Code.gs` 파일 내용을 붙여넣습니다.
        *   왼쪽 사이드바의 "파일" 옆에 있는 "+" 아이콘을 클릭하고 "HTML"을 선택합니다. 새 파일 이름을 `index`로 지정합니다 (자동으로 `index.html`로 저장됨). 이 새 파일의 기본 내용을 삭제하고 **이 프로젝트의** `index.html` 파일 내용을 붙여넣습니다.

5.  **`Code.gs`에서 스프레드시트 ID 업데이트:**
    *   Apps Script 편집기에서 `Code.gs` 파일로 돌아갑니다.
    *   `var SPREADSHEET_ID = "1jLqURqn9hoHZB1r32RC3q6A_U52YiU5Vjc4_0LfV1Tk";` 라인을 찾습니다.
    *   만약 직접 새로 만드신 스프레드시트를 사용하시려면, 위 ID 대신 2단계에서 복사한 본인의 실제 스프레드시트 ID로 이 값을 교체해야 합니다. 이 저장소에 포함된 `SPREADSHEET_ID`는 제공된 예시 ID입니다.

6.  **초기 저장 및 승인 (중요):**
    *   Apps Script에서 프로젝트를 저장합니다 (파일 > 저장, 또는 Ctrl+S/Cmd+S).
    *   승인 프로세스를 시작하려면 함수를 한 번 실행해야 합니다.
    *   Apps Script 편집기의 함수 드롭다운 메뉴에서 아무 함수나 선택합니다 (예: `getCoupons` 또는 `testSaveCoupon` (사용 가능한 경우)).
    *   "실행" 버튼 (재생 아이콘 모양)을 클릭합니다.
    *   Google에서 "권한 검토"를 요청할 것입니다. "권한 검토"를 클릭합니다.
    *   Google 계정을 선택합니다.
    *   "Google에서 이 앱을 확인하지 않았습니다."라는 경고가 표시될 수 있습니다. "고급"을 클릭한 다음 "[프로젝트 이름](으)로 이동 (안전하지 않음)"을 클릭합니다.
    *   스크립트에 필요한 권한(스프레드시트 관리 권한 요청)을 검토하고 "허용"을 클릭합니다.
    *   시트(`Coupons`, `UsageLog`)가 아직 존재하지 않으면 함수 실행이 실패할 수 있지만, 여기서는 승인이 중요합니다. 웹 앱을 처음 사용할 때 해당 시트들이 자동으로 생성됩니다.

7.  **웹 앱으로 배포:**
    *   Apps Script 편집기에서 (일반적으로 오른쪽 상단에 있는) "배포" 버튼을 클릭합니다.
    *   "새 배포"를 선택합니다.
    *   "유형 선택" 옆의 톱니바퀴 아이콘을 클릭하고 "웹 앱"을 선택합니다.
    *   "설명" 필드에 간단한 설명을 추가할 수 있습니다 (예: "쿠폰 관리자").
    *   "다음 사용자로 실행"은 **"나 (your.email@example.com)"**를 선택합니다.
    *   "액세스 권한이 있는 사용자"는 다음 중 하나를 선택합니다:
        *   **"나만"** (본인만 사용할 경우).
        *   **"Google 계정이 있는 모든 사용자"** (도메인/조직 내 다른 사용자가 사용할 경우).
        *   **"모든 사용자"** (공개적으로 액세스 가능하게 하려면 - 주의해서 사용).
        *   *대부분의 개인적인 용도로는 "나만"을 권장합니다.*
    *   "배포"를 클릭합니다.
    *   배포 후 **웹 앱 URL**이 제공됩니다. 이 URL을 복사합니다. 이 링크가 쿠폰 관리 시스템 주소입니다.

8.  **웹 앱 사용:**
    *   이전 단계에서 복사한 웹 앱 URL을 브라우저에서 엽니다.
    *   "Coupons" 및 "UsageLog" 시트는 쿠폰을 처음 저장하거나 사용 내역을 기록할 때, 해당 시트가 아직 없다면 Google 스프레드시트에 자동으로 생성됩니다.
    *   쿠폰을 추가하고 관리하기 시작하세요!

## 작동 방식

*   **`Code.gs`**: 이 파일에는 모든 서버 측 Google Apps Script 함수가 포함되어 있습니다. 다음을 처리합니다:
    *   HTML 페이지 제공 (`doGet`).
    *   쿠폰 데이터를 Google Sheet에 저장 (`saveCoupon`).
    *   쿠폰 데이터 검색 (`getCoupons`, `getLatestCoupons`).
    *   상품권 사용 내역 기록 및 잔액 업데이트 (`logGiftCertificateUsage`).
*   **`index.html`**: 이 파일은 웹 앱 인터페이스의 구조, 스타일 및 클라이언트 측 JavaScript를 정의합니다. `Code.gs` 함수와 통신하여 데이터를 주고받습니다.
*   **Google 스프레드시트**: 데이터베이스 역할을 하며, 모든 쿠폰 및 사용 내역 정보를 "Coupons"와 "UsageLog"라는 두 개의 시트에 저장합니다.

## 참고 사항

*   `Code.gs`의 `SPREADSHEET_ID`가 올바른지 확인하세요.
*   초기 배포 후 `Code.gs` 또는 `index.html`을 변경한 경우, 변경 사항을 웹 앱에 실시간으로 반영하려면 *새로운* 배포를 만들어야 합니다. 배포 > 배포 관리로 이동하여 배포를 선택하고, 연필 아이콘(수정)을 클릭한 다음 버전 드롭다운에서 "새 버전"을 선택하고 "배포"를 클릭합니다.
*   바코드 인식은 수동입니다 (바코드 번호 입력). HTML의 이미지 파일 입력은 향후 개선을 위한 플레이스홀더이며 현재 이미지를 처리하여 바코드를 추출하지는 않습니다.
